{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/block.ts","src/editable.ts","src/editor.ts","src/line.ts","src/main.ts"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import { Editable } from './editable'\n\nexport class Block extends Editable {\n    createField(): HTMLInputElement {\n        return <any>document.createElement('textarea')\n    }\n}\n","import { Editor } from './editor'\n\nexport abstract class Editable {\n    protected elem: HTMLElement\n    protected editor: Editor\n\n    constructor(elem: HTMLElement, editor: Editor) {\n        this.elem = elem\n        this.editor = editor\n    }\n\n    bindEvents() {\n        this.elem.addEventListener('click', (e) => {\n            e.stopPropagation()\n            e.preventDefault()\n\n            if (!this.editor.editionStarted()) {\n                return false\n            }\n\n            const input = this.createField()\n            input.value = this.elem.innerText\n\n            input.addEventListener('blur',  () => {\n                this.elem.innerText = input.value\n                input.parentNode.replaceChild(this.elem, input)\n\n                // Make sure that no one triggers a new click on an editable while this is running\n                setTimeout(() => this.editor.editionEnded(), 50)\n            })\n\n            input.addEventListener('click', (e) => {\n                e.stopPropagation()\n                e.preventDefault()\n            })\n\n            let resize = () => {\n                input.style.height = 'auto'\n                input.style.height = input.scrollHeight + 'px'\n            }\n\n            // Workaround for cut, paste, drop and keydown\n            let delayedResize = () => window.setTimeout(resize, 0)\n\n            input.addEventListener('change', resize)\n            input.addEventListener('cut', delayedResize)\n            input.addEventListener('paste', delayedResize)\n            input.addEventListener('drop', delayedResize)\n            input.addEventListener('keydown', delayedResize)\n\n            input.style.width = 'auto'\n            input.style.height = this.elem.offsetHeight + 'px'\n            input.style.fontSize = window.getComputedStyle(this.elem).fontSize\n\n            this.elem.parentNode.replaceChild(input, this.elem)\n            input.focus()\n            resize()\n        }, true)\n    }\n\n    abstract createField(): HTMLInputElement\n}\n","import { Block } from './block'\nimport { Line } from './line'\nimport { Editable } from './editable'\n\nexport class Editor {\n    private editing: boolean\n\n    constructor() {\n        const elems: HTMLCollectionOf<Element> = document.getElementsByClassName('editable')\n\n        for (let i = 0; i < elems.length; ++i) {\n            let elm: Editable\n\n            if (elems[i].tagName === 'P') {\n                elm = new Block(<HTMLElement>elems[i], this)\n            } else {\n                elm = new Line(<HTMLElement>elems[i], this)\n            }\n\n            elm.bindEvents()\n        }\n    }\n\n    editionStarted() {\n        if (this.editing) {\n            return false\n        }\n\n        this.editing = true\n\n        return true\n    }\n\n    editionEnded() {\n        this.editing = false\n    }\n}\n","import { Editable } from './editable'\n\nexport class Line extends Editable {\n    createField(): HTMLInputElement {\n        return document.createElement('input')\n    }\n}\n","import { Editor } from './editor'\n\n(function () {\n    new Editor()\n})()\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvYmxvY2sudHMiLCJzcmMvZWRpdGFibGUudHMiLCJzcmMvZWRpdG9yLnRzIiwic3JjL2xpbmUudHMiLCJzcmMvbWFpbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7OztBQ0FBLHVDQUFxQztBQUVyQztJQUEyQix5QkFBUTtJQUFuQzs7SUFJQSxDQUFDO0lBSEcsMkJBQVcsR0FBWDtRQUNJLE1BQU0sQ0FBTSxRQUFRLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxDQUFBO0lBQ2xELENBQUM7SUFDTCxZQUFDO0FBQUQsQ0FKQSxBQUlDLENBSjBCLG1CQUFRLEdBSWxDO0FBSlksc0JBQUs7Ozs7O0FDQWxCO0lBSUksa0JBQVksSUFBaUIsRUFBRSxNQUFjO1FBQ3pDLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFBO1FBQ2hCLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFBO0lBQ3hCLENBQUM7SUFFRCw2QkFBVSxHQUFWO1FBQUEsaUJBK0NDO1FBOUNHLElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLFVBQUMsQ0FBQztZQUNsQyxDQUFDLENBQUMsZUFBZSxFQUFFLENBQUE7WUFDbkIsQ0FBQyxDQUFDLGNBQWMsRUFBRSxDQUFBO1lBRWxCLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSSxDQUFDLE1BQU0sQ0FBQyxjQUFjLEVBQUUsQ0FBQyxDQUFDLENBQUM7Z0JBQ2hDLE1BQU0sQ0FBQyxLQUFLLENBQUE7WUFDaEIsQ0FBQztZQUVELElBQU0sS0FBSyxHQUFHLEtBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQTtZQUNoQyxLQUFLLENBQUMsS0FBSyxHQUFHLEtBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFBO1lBRWpDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUc7Z0JBQzVCLEtBQUksQ0FBQyxJQUFJLENB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QUFDLFVBQVUsRUFBRSxDQUFBO1FBQ3BCLENBQUM7SUFDTCxDQUFDO0lBRUQsK0JBQWMsR0FBZDtRQUNJLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1lBQ2YsTUFBTSxDQUFDLEtBQUssQ0FBQTtRQUNoQixDQUFDO1FBRUQsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUE7UUFFbkIsTUFBTSxDQUFDLElBQUksQ0FBQTtJQUNmLENBQUM7SUFFRCw2QkFBWSxHQUFaO1FBQ0ksSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUE7SUFDeEIsQ0FBQztJQUNMLGFBQUM7QUFBRCxDQWhDQSxBQWdDQyxJQUFBO0FBaENZLHdCQUFNOzs7Ozs7Ozs7Ozs7Ozs7QUNKbkIsdUNBQXFDO0FBRXJDO0lBQTBCLHdCQUFRO0lBQWxDOztJQUlBLENBQUM7SUFIRywwQkFBVyxHQUFYO1FBQ0ksTUFBTSxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUE7SUFDMUMsQ0FBQztJQUNMLFdBQUM7QUFBRCxDQUpBLEFBSUMsQ0FKeUIsbUJBQVEsR0FJakM7QUFKWSxvQkFBSTs7Ozs7QUNGakIsbUNBQWlDO0FBRWpDLENBQUM7SUFDRyxJQUFJLGVBQU0sRUFBRSxDQUFBO0FBQ2hCLENBQUMsQ0FBQyxFQUFFLENBQUEiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiaW1wb3J0IHsgRWRpdGFibGUgfSBmcm9tICcuL2VkaXRhYmxlJ1xuXG5leHBvcnQgY2xhc3MgQmxvY2sgZXh0ZW5kcyBFZGl0YWJsZSB7XG4gICAgY3JlYXRlRmllbGQoKTogSFRNTElucHV0RWxlbWVudCB7XG4gICAgICAgIHJldHVybiA8YW55PmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJylcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBFZGl0b3IgfSBmcm9tICcuL2VkaXRvcidcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEVkaXRhYmxlIHtcbiAgICBwcm90ZWN0ZWQgZWxlbTogSFRNTEVsZW1lbnRcbiAgICBwcm90ZWN0ZWQgZWRpdG9yOiBFZGl0b3JcblxuICAgIGNvbnN0cnVjdG9yKGVsZW06IEhUTUxFbGVtZW50LCBlZGl0b3I6IEVkaXRvcikge1xuICAgICAgICB0aGlzLmVsZW0gPSBlbGVtXG4gICAgICAgIHRoaXMuZWRpdG9yID0gZWRpdG9yXG4gICAgfVxuXG4gICAgYmluZEV2ZW50cygpIHtcbiAgICAgICAgdGhpcy5lbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxuXG4gICAgICAgICAgICBpZiAoIXRoaXMuZWRpdG9yLmVkaXRpb25TdGFydGVkKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSB0aGlzLmNyZWF0ZUZpZWxkKClcbiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gdGhpcy5lbGVtLmlubmVyVGV4dFxuXG4gICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW0uaW5uZXJUZXh0ID0gaW5wdXQudmFsdWVcbiAgICAgICAgICAgICAgICBpbnB1dC5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZCh0aGlzLmVsZW0sIGlucHV0KVxuXG4gICAgICAgICAgICAgICAgLy8gTWFrZSBzdXJlIHRoYXQgbm8gb25lIHRyaWdnZXJzIGEgbmV3IGNsaWNrIG9uIGFuIGVkaXRhYmxlIHdoaWxlIHRoaXMgaXMgcnVubmluZ1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5lZGl0b3IuZWRpdGlvbkVuZGVkKCksIDUwKVxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIGxldCByZXNpemUgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaW5wdXQuc3R5bGUuaGVpZ2h0ID0gJ2F1dG8nXG4gICAgICAgICAgICAgICAgaW5wdXQuc3R5bGUuaGVpZ2h0ID0gaW5wdXQuc2Nyb2xsSGVpZ2h0ICsgJ3B4J1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBXb3JrYXJvdW5kIGZvciBjdXQsIHBhc3RlLCBkcm9wIGFuZCBrZXlkb3duXG4gICAgICAgICAgICBsZXQgZGVsYXllZFJlc2l6ZSA9ICgpID0+IHdpbmRvdy5zZXRUaW1lb3V0KHJlc2l6ZSwgMClcblxuICAgICAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgcmVzaXplKVxuICAgICAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY3V0JywgZGVsYXllZFJlc2l6ZSlcbiAgICAgICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ3Bhc3RlJywgZGVsYXllZFJlc2l6ZSlcbiAgICAgICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCBkZWxheWVkUmVzaXplKVxuICAgICAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGRlbGF5ZWRSZXNpemUpXG5cbiAgICAgICAgICAgIGlucHV0LnN0eWxlLndpZHRoID0gJ2F1dG8nXG4gICAgICAgICAgICBpbnB1dC5zdHlsZS5oZWlnaHQgPSB0aGlzLmVsZW0ub2Zmc2V0SGVpZ2h0ICsgJ3B4J1xuICAgICAgICAgICAgaW5wdXQuc3R5bGUuZm9udFNpemUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmVsZW0pLmZvbnRTaXplXG5cbiAgICAgICAgICAgIHRoaXMuZWxlbS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChpbnB1dCwgdGhpcy5lbGVtKVxuICAgICAgICAgICAgaW5wdXQuZm9jdXMoKVxuICAgICAgICAgICAgcmVzaXplKClcbiAgICAgICAgfSwgdHJ1ZSlcbiAgICB9XG5cbiAgICBhYnN0cmFjdCBjcmVhdGVGaWVsZCgpOiBIVE1MSW5wdXRFbGVtZW50XG59XG4iLCJpbXBvcnQgeyBCbG9jayB9IGZyb20gJy4vYmxvY2snXG5pbXBvcnQgeyBMaW5lIH0gZnJvbSAnLi9saW5lJ1xuaW1wb3J0IHsgRWRpdGFibGUgfSBmcm9tICcuL2VkaXRhYmxlJ1xuXG5leHBvcnQgY2xhc3MgRWRpdG9yIHtcbiAgICBwcml2YXRlIGVkaXRpbmc6IGJvb2xlYW5cblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBjb25zdCBlbGVtczogSFRNTENvbGxlY3Rpb25PZjxFbGVtZW50PiA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2VkaXRhYmxlJylcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVsZW1zLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICBsZXQgZWxtOiBFZGl0YWJsZVxuXG4gICAgICAgICAgICBpZiAoZWxlbXNbaV0udGFnTmFtZSA9PT0gJ1AnKSB7XG4gICAgICAgICAgICAgICAgZWxtID0gbmV3IEJsb2NrKDxIVE1MRWxlbWVudD5lbGVtc1tpXSwgdGhpcylcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZWxtID0gbmV3IExpbmUoPEhUTUxFbGVtZW50PmVsZW1zW2ldLCB0aGlzKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBlbG0uYmluZEV2ZW50cygpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBlZGl0aW9uU3RhcnRlZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuZWRpdGluZykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmVkaXRpbmcgPSB0cnVlXG5cbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG5cbiAgICBlZGl0aW9uRW5kZWQoKSB7XG4gICAgICAgIHRoaXMuZWRpdGluZyA9IGZhbHNlXG4gICAgfVxufVxuIiwiaW1wb3J0IHsgRWRpdGFibGUgfSBmcm9tICcuL2VkaXRhYmxlJ1xuXG5leHBvcnQgY2xhc3MgTGluZSBleHRlbmRzIEVkaXRhYmxlIHtcbiAgICBjcmVhdGVGaWVsZCgpOiBIVE1MSW5wdXRFbGVtZW50IHtcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JylcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBFZGl0b3IgfSBmcm9tICcuL2VkaXRvcidcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBuZXcgRWRpdG9yKClcbn0pKClcbiJdfQ=="}