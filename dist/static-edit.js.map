{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/block.ts","src/editable.ts","src/editor.ts","src/line.ts"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;ACAA,uCAAqC;AAErC;IAA2B,yBAAQ;IAAnC;;IAIA,CAAC;IAHG,2BAAW,GAAX;QACI,MAAM,CAAM,QAAQ,CAAC,aAAa,CAAC,UAAU,CAAC,CAAA;IAClD,CAAC;IACL,YAAC;AAAD,CAJA,AAIC,CAJ0B,mBAAQ,GAIlC;AAJY,sBAAK;;;;;ACAlB;IAII,kBAAY,IAAiB,EAAE,MAAc;QACzC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAA;QAChB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAA;IACxB,CAAC;IAED,6BAAU,GAAV;QAAA,iBAiDC;QAhDG,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAC,CAAC;YAClC,CAAC,CAAC,eAAe,EAAE,CAAA;YACnB,CAAC,CAAC,cAAc,EAAE,CAAA;YAElB,EAAE,CAAC,CAAC,CAAC,KAAI,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC;gBAChC,MAAM,CAAC,KAAK,CAAA;YAChB,CAAC;YAED,IAAM,KAAK,GAAG,KAAI,CAAC,WAAW,EAAE,CAAA;YAChC,KAAK,CAAC,KAAK,GAAG,KAAI,CAAC,IAAI,CAAC,SAAS,CAAA;YAEjC,KAAK,CAAC,gBAAgB,CAAC,MAAM,EAAG;gBAC5B,IAAM,QAAQ,GAAG,KAAI,CAAC,IAAI,CAAC,SAAS,CAAA;gBACpC,IAAM,QAAQ,GAAG,KAAK,CAAC,KAAK,CAAA;gBAC5B,KAAI,CAAC,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAA;gBAC9B,KAAK,CAAC,UAAU,CAAC,YAAY,CAAC,KAAI,CAAC,IAAI,EAAE,KAAK,CAAC,CAAA;gBAE/C,kFAAkF;gBAClF,UAAU,CAAC,cAAM,OAAA,KAAI,CAAC,MAAM,CAAC,YAAY,CAAC,KAAI,CAAC,IAAI,EAAE,QAAQ,EAAE,QAAQ,CAAC,EAAvD,CAAuD,EAAE,GAAG,CAAC,CAAA;YAClF,CAAC,CAAC,CAAA;YAEF,KAAK,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAC,CAAC;gBAC9B,CAAC,CAAC,eAAe,EAAE,CAAA;gBACnB,CAAC,CAAC,cAAc,EAAE,CAAA;YACtB,CAAC,CAAC,CAAA;YAEF,IAAI,MAAM,GAAG;gBACT,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAA;gBAC3B,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC,YAAY,GAAG,IAAI,CAAA;YAClD,CAAC,CAAA;YAED,8CAA8C;YAC9C,IAAI,aAAa,GAAG,cAAM,OAAA,MAAM,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,CAAC,EAA5B,CAA4B,CAAA;YAEtD,KAAK,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAA;YACxC,KAAK,CAAC,gBAAgB,CAAC,KAAK,EAAE,aAAa,CAAC,CAAA;YAC5C,KAAK,CAAC,gBAAgB,CAAC,OAAO,EAAE,aAAa,CAAC,CAAA;YAC9C,KAAK,CAAC,gBAAgB,CAAC,MAAM,EAAE,aAAa,CAAC,CAAA;YAC7C,KAAK,CAAC,gBAAgB,CAAC,SAAS,EAAE,aAAa,CAAC,CAAA;YAEhD,KAAK,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAA;YAC1B,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,KAAI,CAAC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAA;YAClD,KAAK,CAAC,KAAK,CAAC,QAAQ,GAAG,MAAM,CAAC,gBAAgB,CAAC,KAAI,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAA;YAElE,KAAI,CAAC,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,KAAK,EAAE,KAAI,CAAC,IAAI,CAAC,CAAA;YACnD,KAAK,CAAC,KAAK,EAAE,CAAA;YACb,MAAM,EAAE,CAAA;QACZ,CAAC,EAAE,IAAI,CAAC,CAAA;IACZ,CAAC;IAGL,eAAC;AAAD,CA7DA,AA6DC,IAAA;AA7DqB,4BAAQ;;;;;ACF9B,iCAA+B;AAC/B,+BAA6B;AAG7B;IAGI;QACI,IAAM,KAAK,GAA8B,QAAQ,CAAC,sBAAsB,CAAC,UAAU,CAAC,CAAA;QAEpF,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE,CAAC;YACpC,IAAI,GAAG,SAAU,CAAA;YAEjB,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,OAAO,KAAK,GAAG,CAAC,CAAC,CAAC;gBAC3B,GAAG,GAAG,IAAI,aAAK,CAAc,KAAK,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,CAAA;YAChD,CAAC;YAAC,IAAI,CAAC,CAAC;gBACJ,GAAG,GAAG,IAAI,WAAI,CAAc,KAAK,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,CAAA;YAC/C,CAAC;YAED,GAAG,CAAC,UAAU,EAAE,CAAA;QACpB,CAAC;IACL,CAAC;IAED,+BAAc,GAAd;QACI,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;YACf,MAAM,CAAC,KAAK,CAAA;QAChB,CAAC;QAED,IAAI,CAAC,OAAO,GAAG,IAAI,CAAA;QAEnB,MAAM,CAAC,IAAI,CAAA;IACf,CAAC;IAED,6BAAY,GAAZ,UAAa,IAAiB,EAAE,QAAgB,EAAE,QAAgB;QAC9D,IAAI,CAAC,OAAO,GAAG,KAAK,CAAA;QAEpB,IAAI,YAAY,GAAG,IAAI,WAAW,CAAC,eAAe,EAAE,EAAC,MAAM,EAAE,EAAC,IAAI,MAAA,EAAE,QAAQ,UAAA,EAAE,QAAQ,UAAA,EAAC,EAAC,CAAC,CAAA;QACzF,MAAM,CAAC,aAAa,CAAC,YAAY,CAAC,CAAA;IACtC,CAAC;IACL,aAAC;AAAD,CAnCA,AAmCC,IAAA;AAnCY,wBAAM;;;;;;;;;;;;;;;ACJnB,uCAAqC;AAErC;IAA0B,wBAAQ;IAAlC;;IAIA,CAAC;IAHG,0BAAW,GAAX;QACI,MAAM,CAAC,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAA;IAC1C,CAAC;IACL,WAAC;AAAD,CAJA,AAIC,CAJyB,mBAAQ,GAIjC;AAJY,oBAAI","file":"static-edit.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import { Editable } from './editable'\n\nexport class Block extends Editable {\n    createField(): HTMLInputElement {\n        return <any>document.createElement('textarea')\n    }\n}\n","import { Editor } from './editor'\n\nexport abstract class Editable {\n    protected elem: HTMLElement\n    protected editor: Editor\n\n    constructor(elem: HTMLElement, editor: Editor) {\n        this.elem = elem\n        this.editor = editor\n    }\n\n    bindEvents() {\n        this.elem.addEventListener('click', (e) => {\n            e.stopPropagation()\n            e.preventDefault()\n\n            if (!this.editor.editionStarted()) {\n                return false\n            }\n\n            const input = this.createField()\n            input.value = this.elem.innerText\n\n            input.addEventListener('blur',  () => {\n                const oldValue = this.elem.innerText\n                const newValue = input.value\n                this.elem.innerText = newValue\n                input.parentNode.replaceChild(this.elem, input)\n\n                // Make sure that no one triggers a new click on an editable while this is running\n                setTimeout(() => this.editor.editionEnded(this.elem, oldValue, newValue), 100)\n            })\n\n            input.addEventListener('click', (e) => {\n                e.stopPropagation()\n                e.preventDefault()\n            })\n\n            let resize = () => {\n                input.style.height = 'auto'\n                input.style.height = input.scrollHeight + 'px'\n            }\n\n            // Workaround for cut, paste, drop and keydown\n            let delayedResize = () => window.setTimeout(resize, 0)\n\n            input.addEventListener('change', resize)\n            input.addEventListener('cut', delayedResize)\n            input.addEventListener('paste', delayedResize)\n            input.addEventListener('drop', delayedResize)\n            input.addEventListener('keydown', delayedResize)\n\n            input.style.width = 'auto'\n            input.style.height = this.elem.offsetHeight + 'px'\n            input.style.fontSize = window.getComputedStyle(this.elem).fontSize\n\n            this.elem.parentNode.replaceChild(input, this.elem)\n            input.focus()\n            resize()\n        }, true)\n    }\n\n    abstract createField(): HTMLInputElement\n}\n","import { Block } from './block'\nimport { Line } from './line'\nimport { Editable } from './editable'\n\nexport class Editor {\n    private editing: boolean\n\n    constructor() {\n        const elems: HTMLCollectionOf<Element> = document.getElementsByClassName('editable')\n\n        for (let i = 0; i < elems.length; ++i) {\n            let elm: Editable\n\n            if (elems[i].tagName === 'P') {\n                elm = new Block(<HTMLElement>elems[i], this)\n            } else {\n                elm = new Line(<HTMLElement>elems[i], this)\n            }\n\n            elm.bindEvents()\n        }\n    }\n\n    editionStarted() {\n        if (this.editing) {\n            return false\n        }\n\n        this.editing = true\n\n        return true\n    }\n\n    editionEnded(elem: HTMLElement, oldValue: string, newValue: string) {\n        this.editing = false\n\n        let editionEnded = new CustomEvent('edition_ended', {detail: {elem, oldValue, newValue}})\n        window.dispatchEvent(editionEnded)\n    }\n}\n","import { Editable } from './editable'\n\nexport class Line extends Editable {\n    createField(): HTMLInputElement {\n        return document.createElement('input')\n    }\n}\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvYmxvY2sudHMiLCJzcmMvZWRpdGFibGUudHMiLCJzcmMvZWRpdG9yLnRzIiwic3JjL2xpbmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7QUNBQSx1Q0FBcUM7QUFFckM7SUFBMkIseUJBQVE7SUFBbkM7O0lBSUEsQ0FBQztJQUhHLDJCQUFXLEdBQVg7UUFDSSxNQUFNLENBQU0sUUFBUSxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsQ0FBQTtJQUNsRCxDQUFDO0lBQ0wsWUFBQztBQUFELENBSkEsQUFJQyxDQUowQixtQkFBUSxHQUlsQztBQUpZLHNCQUFLOzs7OztBQ0FsQjtJQUlJLGtCQUFZLElBQWlCLEVBQUUsTUFBYztRQUN6QyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQTtRQUNoQixJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQTtJQUN4QixDQUFDO0lBRUQsNkJBQVUsR0FBVjtRQUFBLGlCQWlEQztRQWhERyxJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxVQUFDLENBQUM7WUFDbEMsQ0FBQyxDQUFDLGVBQWUsRUFBRSxDQUFBO1lBQ25CLENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQTtZQUVsQixFQUFFLENBQUMsQ0FBQyxDQUFDLEtBQUksQ0FBQyxNQUFNLENBQUMsY0FBYyxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUNoQyxNQUFNLENBQUMsS0FBSyxDQUFBO1lBQ2hCLENBQUM7WUFFRCxJQUFNLEtBQUssR0FBRyxLQUFJLENBQUMsV0FBVyxFQUFFLENBQUE7WUFDaEMsS0FBSyxDQUFDLEtBQUssR0FBRyxLQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQTtZQUVqQyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxFQUFHO2dCQUM1QixJQUFNLFFBQVEsR0FBRyxLQUFJLENBQUMsSUFBSSxD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QyxJQUFJLENBQUMsQ0FBQztnQkFDSixHQUFHLEdBQUcsSUFBSSxXQUFJLENBQWMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFBO1lBQy9DLENBQUM7WUFFRCxHQUFHLENBQUMsVUFBVSxFQUFFLENBQUE7UUFDcEIsQ0FBQztJQUNMLENBQUM7SUFFRCwrQkFBYyxHQUFkO1FBQ0ksRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7WUFDZixNQUFNLENBQUMsS0FBSyxDQUFBO1FBQ2hCLENBQUM7UUFFRCxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQTtRQUVuQixNQUFNLENBQUMsSUFBSSxDQUFBO0lBQ2YsQ0FBQztJQUVELDZCQUFZLEdBQVosVUFBYSxJQUFpQixFQUFFLFFBQWdCLEVBQUUsUUFBZ0I7UUFDOUQsSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUE7UUFFcEIsSUFBSSxZQUFZLEdBQUcsSUFBSSxXQUFXLENBQUMsZUFBZSxFQUFFLEVBQUMsTUFBTSxFQUFFLEVBQUMsSUFBSSxNQUFBLEVBQUUsUUFBUSxVQUFBLEVBQUUsUUFBUSxVQUFBLEVBQUMsRUFBQyxDQUFDLENBQUE7UUFDekYsTUFBTSxDQUFDLGFBQWEsQ0FBQyxZQUFZLENBQUMsQ0FBQTtJQUN0QyxDQUFDO0lBQ0wsYUFBQztBQUFELENBbkNBLEFBbUNDLElBQUE7QUFuQ1ksd0JBQU07Ozs7Ozs7Ozs7Ozs7OztBQ0puQix1Q0FBcUM7QUFFckM7SUFBMEIsd0JBQVE7SUFBbEM7O0lBSUEsQ0FBQztJQUhHLDBCQUFXLEdBQVg7UUFDSSxNQUFNLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQTtJQUMxQyxDQUFDO0lBQ0wsV0FBQztBQUFELENBSkEsQUFJQyxDQUp5QixtQkFBUSxHQUlqQztBQUpZLG9CQUFJIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImltcG9ydCB7IEVkaXRhYmxlIH0gZnJvbSAnLi9lZGl0YWJsZSdcblxuZXhwb3J0IGNsYXNzIEJsb2NrIGV4dGVuZHMgRWRpdGFibGUge1xuICAgIGNyZWF0ZUZpZWxkKCk6IEhUTUxJbnB1dEVsZW1lbnQge1xuICAgICAgICByZXR1cm4gPGFueT5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpXG4gICAgfVxufVxuIiwiaW1wb3J0IHsgRWRpdG9yIH0gZnJvbSAnLi9lZGl0b3InXG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBFZGl0YWJsZSB7XG4gICAgcHJvdGVjdGVkIGVsZW06IEhUTUxFbGVtZW50XG4gICAgcHJvdGVjdGVkIGVkaXRvcjogRWRpdG9yXG5cbiAgICBjb25zdHJ1Y3RvcihlbGVtOiBIVE1MRWxlbWVudCwgZWRpdG9yOiBFZGl0b3IpIHtcbiAgICAgICAgdGhpcy5lbGVtID0gZWxlbVxuICAgICAgICB0aGlzLmVkaXRvciA9IGVkaXRvclxuICAgIH1cblxuICAgIGJpbmRFdmVudHMoKSB7XG4gICAgICAgIHRoaXMuZWxlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcblxuICAgICAgICAgICAgaWYgKCF0aGlzLmVkaXRvci5lZGl0aW9uU3RhcnRlZCgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gdGhpcy5jcmVhdGVGaWVsZCgpXG4gICAgICAgICAgICBpbnB1dC52YWx1ZSA9IHRoaXMuZWxlbS5pbm5lclRleHRcblxuICAgICAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSB0aGlzLmVsZW0uaW5uZXJUZXh0XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSBpbnB1dC52YWx1ZVxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbS5pbm5lclRleHQgPSBuZXdWYWx1ZVxuICAgICAgICAgICAgICAgIGlucHV0LnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKHRoaXMuZWxlbSwgaW5wdXQpXG5cbiAgICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhhdCBubyBvbmUgdHJpZ2dlcnMgYSBuZXcgY2xpY2sgb24gYW4gZWRpdGFibGUgd2hpbGUgdGhpcyBpcyBydW5uaW5nXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLmVkaXRvci5lZGl0aW9uRW5kZWQodGhpcy5lbGVtLCBvbGRWYWx1ZSwgbmV3VmFsdWUpLCAxMDApXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgbGV0IHJlc2l6ZSA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBpbnB1dC5zdHlsZS5oZWlnaHQgPSAnYXV0bydcbiAgICAgICAgICAgICAgICBpbnB1dC5zdHlsZS5oZWlnaHQgPSBpbnB1dC5zY3JvbGxIZWlnaHQgKyAncHgnXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFdvcmthcm91bmQgZm9yIGN1dCwgcGFzdGUsIGRyb3AgYW5kIGtleWRvd25cbiAgICAgICAgICAgIGxldCBkZWxheWVkUmVzaXplID0gKCkgPT4gd2luZG93LnNldFRpbWVvdXQocmVzaXplLCAwKVxuXG4gICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCByZXNpemUpXG4gICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjdXQnLCBkZWxheWVkUmVzaXplKVxuICAgICAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigncGFzdGUnLCBkZWxheWVkUmVzaXplKVxuICAgICAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIGRlbGF5ZWRSZXNpemUpXG4gICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZGVsYXllZFJlc2l6ZSlcblxuICAgICAgICAgICAgaW5wdXQuc3R5bGUud2lkdGggPSAnYXV0bydcbiAgICAgICAgICAgIGlucHV0LnN0eWxlLmhlaWdodCA9IHRoaXMuZWxlbS5vZmZzZXRIZWlnaHQgKyAncHgnXG4gICAgICAgICAgICBpbnB1dC5zdHlsZS5mb250U2l6ZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMuZWxlbSkuZm9udFNpemVcblxuICAgICAgICAgICAgdGhpcy5lbGVtLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKGlucHV0LCB0aGlzLmVsZW0pXG4gICAgICAgICAgICBpbnB1dC5mb2N1cygpXG4gICAgICAgICAgICByZXNpemUoKVxuICAgICAgICB9LCB0cnVlKVxuICAgIH1cblxuICAgIGFic3RyYWN0IGNyZWF0ZUZpZWxkKCk6IEhUTUxJbnB1dEVsZW1lbnRcbn1cbiIsImltcG9ydCB7IEJsb2NrIH0gZnJvbSAnLi9ibG9jaydcbmltcG9ydCB7IExpbmUgfSBmcm9tICcuL2xpbmUnXG5pbXBvcnQgeyBFZGl0YWJsZSB9IGZyb20gJy4vZWRpdGFibGUnXG5cbmV4cG9ydCBjbGFzcyBFZGl0b3Ige1xuICAgIHByaXZhdGUgZWRpdGluZzogYm9vbGVhblxuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIGNvbnN0IGVsZW1zOiBIVE1MQ29sbGVjdGlvbk9mPEVsZW1lbnQ+ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZWRpdGFibGUnKVxuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZWxlbXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIGxldCBlbG06IEVkaXRhYmxlXG5cbiAgICAgICAgICAgIGlmIChlbGVtc1tpXS50YWdOYW1lID09PSAnUCcpIHtcbiAgICAgICAgICAgICAgICBlbG0gPSBuZXcgQmxvY2soPEhUTUxFbGVtZW50PmVsZW1zW2ldLCB0aGlzKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbG0gPSBuZXcgTGluZSg8SFRNTEVsZW1lbnQ+ZWxlbXNbaV0sIHRoaXMpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGVsbS5iaW5kRXZlbnRzKClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGVkaXRpb25TdGFydGVkKCkge1xuICAgICAgICBpZiAodGhpcy5lZGl0aW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZWRpdGluZyA9IHRydWVcblxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIGVkaXRpb25FbmRlZChlbGVtOiBIVE1MRWxlbWVudCwgb2xkVmFsdWU6IHN0cmluZywgbmV3VmFsdWU6IHN0cmluZykge1xuICAgICAgICB0aGlzLmVkaXRpbmcgPSBmYWxzZVxuXG4gICAgICAgIGxldCBlZGl0aW9uRW5kZWQgPSBuZXcgQ3VzdG9tRXZlbnQoJ2VkaXRpb25fZW5kZWQnLCB7ZGV0YWlsOiB7ZWxlbSwgb2xkVmFsdWUsIG5ld1ZhbHVlfX0pXG4gICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KGVkaXRpb25FbmRlZClcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBFZGl0YWJsZSB9IGZyb20gJy4vZWRpdGFibGUnXG5cbmV4cG9ydCBjbGFzcyBMaW5lIGV4dGVuZHMgRWRpdGFibGUge1xuICAgIGNyZWF0ZUZpZWxkKCk6IEhUTUxJbnB1dEVsZW1lbnQge1xuICAgICAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKVxuICAgIH1cbn1cbiJdfQ=="}