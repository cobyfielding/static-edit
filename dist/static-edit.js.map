{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/block.ts","src/editable.ts","src/editor.ts","src/line.ts"],"names":[],"mappings":"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","file":"static-edit.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import { Editable } from './editable'\n\nexport class Block extends Editable {\n    createField(): HTMLInputElement {\n        return <any>document.createElement('textarea')\n    }\n}\n","import { Editor } from './editor'\n\nexport abstract class Editable {\n    protected elem: HTMLElement\n    protected editor: Editor\n    private changed: boolean\n\n    constructor(elem: HTMLElement, editor: Editor) {\n        this.elem = elem\n        this.editor = editor\n    }\n\n    bindEvents() {\n        this.elem.addEventListener('click', (e) => {\n            e.stopPropagation()\n            e.preventDefault()\n\n            if (!this.editor.editionStarted()) {\n                return false\n            }\n\n            const input = this.createField()\n            input.value = this.elem.innerText\n\n            input.addEventListener('blur', () => {\n                const oldValue = this.elem.innerText\n                const newValue = input.value\n                this.elem.innerText = newValue\n                this.changed = true\n                input.parentNode.replaceChild(this.elem, input)\n\n                // Make sure that no one triggers a new click on an editable while this is running\n                setTimeout(() => this.editor.editionEnded(this.elem, oldValue, newValue), 100)\n            })\n\n            input.addEventListener('click', (e) => {\n                e.stopPropagation()\n                e.preventDefault()\n            })\n\n            let resize = () => {\n                input.style.height = 'auto'\n                input.style.height = input.scrollHeight + 'px'\n            }\n\n            // Workaround for cut, paste, drop and keydown\n            let delayedResize = () => window.setTimeout(resize, 0)\n\n            input.addEventListener('change', resize)\n            input.addEventListener('cut', delayedResize)\n            input.addEventListener('paste', delayedResize)\n            input.addEventListener('drop', delayedResize)\n            input.addEventListener('keydown', delayedResize)\n\n            input.style.width = 'auto'\n            input.style.height = this.elem.offsetHeight + 'px'\n            input.style.fontSize = window.getComputedStyle(this.elem).fontSize\n\n            this.elem.parentNode.replaceChild(input, this.elem)\n            input.focus()\n            resize()\n        }, true)\n    }\n\n    abstract createField(): HTMLInputElement\n\n    get value(): string {\n        return this.elem.textContent\n    }\n\n    get element(): HTMLElement {\n        return this.elem\n    }\n\n    get hasChanged(): boolean {\n        return this.changed\n    }\n}\n","import { Block } from './block'\nimport { Line } from './line'\nimport { Editable } from './editable'\n\ntype Options = {\n    saveButton: boolean\n}\n\nexport class Editor {\n    private editing: boolean\n    private elems: Editable[]\n\n    constructor(private options: Options) {\n        this.elems = []\n        const elems: HTMLCollectionOf<Element> = document.getElementsByClassName('editable')\n\n        for (let i = 0; i < elems.length; ++i) {\n            let elm: Editable\n\n            if (elems[i].tagName === 'P') {\n                elm = new Block(<HTMLElement>elems[i], this)\n            } else {\n                elm = new Line(<HTMLElement>elems[i], this)\n            }\n\n            elm.bindEvents()\n            this.elems.push(elm)\n        }\n\n        this.handleOptions()\n    }\n\n    handleOptions() {\n        if (this.options.saveButton === true) {\n            const button = document.createElement('button')\n            button.addEventListener('click', (e) => {\n                e.preventDefault()\n                e.stopPropagation()\n                let saving = new CustomEvent('static_edit.saving', {detail: {changed: this.elems.filter((e) => e.hasChanged)}})\n                window.dispatchEvent(saving)\n            })\n\n            button.textContent = 'Save'\n            button.style.position = 'absolute'\n            button.style.top = '20px'\n            button.style.left = '20px'\n            document.body.appendChild(button)\n        }\n    }\n\n    editionStarted() {\n        if (this.editing) {\n            return false\n        }\n\n        this.editing = true\n\n        return true\n    }\n\n    editionEnded(elem: HTMLElement, oldValue: string, newValue: string) {\n        this.editing = false\n\n        let editionEnded = new CustomEvent('static_edit.edited', {detail: {elem, oldValue, newValue}})\n        window.dispatchEvent(editionEnded)\n    }\n}\n","import { Editable } from './editable'\n\nexport class Line extends Editable {\n    createField(): HTMLInputElement {\n        return document.createElement('input')\n    }\n}\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvYmxvY2sudHMiLCJzcmMvZWRpdGFibGUudHMiLCJzcmMvZWRpdG9yLnRzIiwic3JjL2xpbmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7QUNBQSx1Q0FBcUM7QUFFckM7SUFBMkIseUJBQVE7SUFBbkM7O0lBSUEsQ0FBQztJQUhHLDJCQUFXLEdBQVg7UUFDSSxNQUFNLENBQU0sUUFBUSxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsQ0FBQTtJQUNsRCxDQUFDO0lBQ0wsWUFBQztBQUFELENBSkEsQUFJQyxDQUowQixtQkFBUSxHQUlsQztBQUpZLHNCQUFLOzs7OztBQ0FsQjtJQUtJLGtCQUFZLElBQWlCLEVBQUUsTUFBYztRQUN6QyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQTtRQUNoQixJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQTtJQUN4QixDQUFDO0lBRUQsNkJBQVUsR0FBVjtRQUFBLGlCQWtEQztRQWpERyxJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxVQUFDLENBQUM7WUFDbEMsQ0FBQyxDQUFDLGVBQWUsRUFBRSxDQUFBO1lBQ25CLENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQTtZQUVsQixFQUFFLENBQUMsQ0FBQyxDQUFDLEtBQUksQ0FBQyxNQUFNLENBQUMsY0FBYyxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUNoQyxNQUFNLENBQUMsS0FBSyxDQUFBO1lBQ2hCLENBQUM7WUFFRCxJQUFNLEtBQUssR0FBRyxLQUFJLENBQUMsV0FBVyxFQUFFLENBQUE7WUFDaEMsS0FBSyxDQUFDLEtBQUssR0FBRyxLQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQTtZQUVqQyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxFQUFFO2dCQUMzQixJQUFNLFFBQVEsR0FBRyxLQUFJLENBQUMsSUFBSSxD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QTtBQTFEWSx3QkFBTTs7Ozs7Ozs7Ozs7Ozs7O0FDUm5CLHVDQUFxQztBQUVyQztJQUEwQix3QkFBUTtJQUFsQzs7SUFJQSxDQUFDO0lBSEcsMEJBQVcsR0FBWDtRQUNJLE1BQU0sQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFBO0lBQzFDLENBQUM7SUFDTCxXQUFDO0FBQUQsQ0FKQSxBQUlDLENBSnlCLG1CQUFRLEdBSWpDO0FBSlksb0JBQUkiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiaW1wb3J0IHsgRWRpdGFibGUgfSBmcm9tICcuL2VkaXRhYmxlJ1xuXG5leHBvcnQgY2xhc3MgQmxvY2sgZXh0ZW5kcyBFZGl0YWJsZSB7XG4gICAgY3JlYXRlRmllbGQoKTogSFRNTElucHV0RWxlbWVudCB7XG4gICAgICAgIHJldHVybiA8YW55PmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJylcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBFZGl0b3IgfSBmcm9tICcuL2VkaXRvcidcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEVkaXRhYmxlIHtcbiAgICBwcm90ZWN0ZWQgZWxlbTogSFRNTEVsZW1lbnRcbiAgICBwcm90ZWN0ZWQgZWRpdG9yOiBFZGl0b3JcbiAgICBwcml2YXRlIGNoYW5nZWQ6IGJvb2xlYW5cblxuICAgIGNvbnN0cnVjdG9yKGVsZW06IEhUTUxFbGVtZW50LCBlZGl0b3I6IEVkaXRvcikge1xuICAgICAgICB0aGlzLmVsZW0gPSBlbGVtXG4gICAgICAgIHRoaXMuZWRpdG9yID0gZWRpdG9yXG4gICAgfVxuXG4gICAgYmluZEV2ZW50cygpIHtcbiAgICAgICAgdGhpcy5lbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxuXG4gICAgICAgICAgICBpZiAoIXRoaXMuZWRpdG9yLmVkaXRpb25TdGFydGVkKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSB0aGlzLmNyZWF0ZUZpZWxkKClcbiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gdGhpcy5lbGVtLmlubmVyVGV4dFxuXG4gICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9sZFZhbHVlID0gdGhpcy5lbGVtLmlubmVyVGV4dFxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gaW5wdXQudmFsdWVcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW0uaW5uZXJUZXh0ID0gbmV3VmFsdWVcbiAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZWQgPSB0cnVlXG4gICAgICAgICAgICAgICAgaW5wdXQucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQodGhpcy5lbGVtLCBpbnB1dClcblxuICAgICAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IG5vIG9uZSB0cmlnZ2VycyBhIG5ldyBjbGljayBvbiBhbiBlZGl0YWJsZSB3aGlsZSB0aGlzIGlzIHJ1bm5pbmdcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuZWRpdG9yLmVkaXRpb25FbmRlZCh0aGlzLmVsZW0sIG9sZFZhbHVlLCBuZXdWYWx1ZSksIDEwMClcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICBsZXQgcmVzaXplID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlucHV0LnN0eWxlLmhlaWdodCA9ICdhdXRvJ1xuICAgICAgICAgICAgICAgIGlucHV0LnN0eWxlLmhlaWdodCA9IGlucHV0LnNjcm9sbEhlaWdodCArICdweCdcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gV29ya2Fyb3VuZCBmb3IgY3V0LCBwYXN0ZSwgZHJvcCBhbmQga2V5ZG93blxuICAgICAgICAgICAgbGV0IGRlbGF5ZWRSZXNpemUgPSAoKSA9PiB3aW5kb3cuc2V0VGltZW91dChyZXNpemUsIDApXG5cbiAgICAgICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHJlc2l6ZSlcbiAgICAgICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2N1dCcsIGRlbGF5ZWRSZXNpemUpXG4gICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdwYXN0ZScsIGRlbGF5ZWRSZXNpemUpXG4gICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgZGVsYXllZFJlc2l6ZSlcbiAgICAgICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBkZWxheWVkUmVzaXplKVxuXG4gICAgICAgICAgICBpbnB1dC5zdHlsZS53aWR0aCA9ICdhdXRvJ1xuICAgICAgICAgICAgaW5wdXQuc3R5bGUuaGVpZ2h0ID0gdGhpcy5lbGVtLm9mZnNldEhlaWdodCArICdweCdcbiAgICAgICAgICAgIGlucHV0LnN0eWxlLmZvbnRTaXplID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy5lbGVtKS5mb250U2l6ZVxuXG4gICAgICAgICAgICB0aGlzLmVsZW0ucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQoaW5wdXQsIHRoaXMuZWxlbSlcbiAgICAgICAgICAgIGlucHV0LmZvY3VzKClcbiAgICAgICAgICAgIHJlc2l6ZSgpXG4gICAgICAgIH0sIHRydWUpXG4gICAgfVxuXG4gICAgYWJzdHJhY3QgY3JlYXRlRmllbGQoKTogSFRNTElucHV0RWxlbWVudFxuXG4gICAgZ2V0IHZhbHVlKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW0udGV4dENvbnRlbnRcbiAgICB9XG5cbiAgICBnZXQgZWxlbWVudCgpOiBIVE1MRWxlbWVudCB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1cbiAgICB9XG5cbiAgICBnZXQgaGFzQ2hhbmdlZCgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hhbmdlZFxuICAgIH1cbn1cbiIsImltcG9ydCB7IEJsb2NrIH0gZnJvbSAnLi9ibG9jaydcbmltcG9ydCB7IExpbmUgfSBmcm9tICcuL2xpbmUnXG5pbXBvcnQgeyBFZGl0YWJsZSB9IGZyb20gJy4vZWRpdGFibGUnXG5cbnR5cGUgT3B0aW9ucyA9IHtcbiAgICBzYXZlQnV0dG9uOiBib29sZWFuXG59XG5cbmV4cG9ydCBjbGFzcyBFZGl0b3Ige1xuICAgIHByaXZhdGUgZWRpdGluZzogYm9vbGVhblxuICAgIHByaXZhdGUgZWxlbXM6IEVkaXRhYmxlW11cblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgb3B0aW9uczogT3B0aW9ucykge1xuICAgICAgICB0aGlzLmVsZW1zID0gW11cbiAgICAgICAgY29uc3QgZWxlbXM6IEhUTUxDb2xsZWN0aW9uT2Y8RWxlbWVudD4gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdlZGl0YWJsZScpXG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbGVtcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgbGV0IGVsbTogRWRpdGFibGVcblxuICAgICAgICAgICAgaWYgKGVsZW1zW2ldLnRhZ05hbWUgPT09ICdQJykge1xuICAgICAgICAgICAgICAgIGVsbSA9IG5ldyBCbG9jayg8SFRNTEVsZW1lbnQ+ZWxlbXNbaV0sIHRoaXMpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVsbSA9IG5ldyBMaW5lKDxIVE1MRWxlbWVudD5lbGVtc1tpXSwgdGhpcylcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZWxtLmJpbmRFdmVudHMoKVxuICAgICAgICAgICAgdGhpcy5lbGVtcy5wdXNoKGVsbSlcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuaGFuZGxlT3B0aW9ucygpXG4gICAgfVxuXG4gICAgaGFuZGxlT3B0aW9ucygpIHtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5zYXZlQnV0dG9uID09PSB0cnVlKSB7XG4gICAgICAgICAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKVxuICAgICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgICAgICAgICAgICAgbGV0IHNhdmluZyA9IG5ldyBDdXN0b21FdmVudCgnc3RhdGljX2VkaXQuc2F2aW5nJywge2RldGFpbDoge2NoYW5nZWQ6IHRoaXMuZWxlbXMuZmlsdGVyKChlKSA9PiBlLmhhc0NoYW5nZWQpfX0pXG4gICAgICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQoc2F2aW5nKVxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgYnV0dG9uLnRleHRDb250ZW50ID0gJ1NhdmUnXG4gICAgICAgICAgICBidXR0b24uc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnXG4gICAgICAgICAgICBidXR0b24uc3R5bGUudG9wID0gJzIwcHgnXG4gICAgICAgICAgICBidXR0b24uc3R5bGUubGVmdCA9ICcyMHB4J1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChidXR0b24pXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBlZGl0aW9uU3RhcnRlZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuZWRpdGluZykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmVkaXRpbmcgPSB0cnVlXG5cbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG5cbiAgICBlZGl0aW9uRW5kZWQoZWxlbTogSFRNTEVsZW1lbnQsIG9sZFZhbHVlOiBzdHJpbmcsIG5ld1ZhbHVlOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5lZGl0aW5nID0gZmFsc2VcblxuICAgICAgICBsZXQgZWRpdGlvbkVuZGVkID0gbmV3IEN1c3RvbUV2ZW50KCdzdGF0aWNfZWRpdC5lZGl0ZWQnLCB7ZGV0YWlsOiB7ZWxlbSwgb2xkVmFsdWUsIG5ld1ZhbHVlfX0pXG4gICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KGVkaXRpb25FbmRlZClcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBFZGl0YWJsZSB9IGZyb20gJy4vZWRpdGFibGUnXG5cbmV4cG9ydCBjbGFzcyBMaW5lIGV4dGVuZHMgRWRpdGFibGUge1xuICAgIGNyZWF0ZUZpZWxkKCk6IEhUTUxJbnB1dEVsZW1lbnQge1xuICAgICAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKVxuICAgIH1cbn1cbiJdfQ=="}